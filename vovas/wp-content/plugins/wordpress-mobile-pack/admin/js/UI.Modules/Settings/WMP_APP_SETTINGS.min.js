function WMP_APP_SETTINGS(){var a=this;this.type="wmp_editsettings",this.form,this.DOMDoc,this.send_btn,this.init=function(){WMPJSInterface=window.parent.WMPJSInterface,this.send_btn=jQuery("#"+this.type+"_send_btn",this.DOMDoc).get(0),this.form=this.DOMDoc.getElementById(this.type+"_form"),this.addButtonsActions(),null!=this.form&&this.initValidation()},this.initValidation=function(){jQuery.validator.addMethod("regex",function(a,b,c){var d=new RegExp(c,"i");return this.optional(b)||d.test(a)},"Your code is invalid"),this.validator=jQuery("#"+this.form.id,this.DOMDoc).validate({rules:{wmp_editsettings_ganalyticsid:{regex:"^ua-\\d{4,9}-\\d{1,4}$"}},errorPlacement:function(b,c){var d=c[0].id.split("_"),e=d.length>1?d[d.length-1]:d[0],f=jQuery("#error_"+e+"_container",a.DOMDoc);b.appendTo(f)},errorElement:"span"}),jQuery("#wmp_enable_tablets_check",a.DOMDoc).change(function(){this.checked?jQuery("#"+a.type+"_enable_tablets",a.DOMDoc).val("1"):jQuery("#"+a.type+"_enable_tablets",a.DOMDoc).val("0")}),jQuery("#wmp_displaywebsitelink_check",a.DOMDoc).change(function(){this.checked?jQuery("#"+a.type+"_displaywebsitelink",a.DOMDoc).val("1"):jQuery("#"+a.type+"_displaywebsitelink",a.DOMDoc).val("0")})},this.addButtonsActions=function(){jQuery(this.send_btn).unbind("click"),jQuery(this.send_btn).bind("click",function(){a.disableButton(this),a.validate()}),a.enableButton(this.send_btn),jQuery("#"+a.form.id,a.DOMDoc).bind("keypress",function(a){if(13==a.keyCode)return!1})},this.enableButton=function(a){jQuery(a).css("cursor","pointer"),jQuery(a).animate({opacity:1},100)},this.disableButton=function(a){jQuery(a).unbind("click"),jQuery(a).animate({opacity:.4},100),jQuery(a).css("cursor","default")},this.scrollToError=function(b){var c=jQuery("html,body",a.DOMDoc),d=parseInt(jQuery("html,body").scrollTop())||parseInt(jQuery("body").scrollTop()),e=c.get(0).clientHeight;parseInt(c.offset().top);b<d?jQuery(c).animate({scrollTop:b-20},1e3):b>d+e&&jQuery(c).animate({scrollTop:d+e},1e3)},this.validate=function(){jQuery(this.form).validate().form();var b=[];for(var c in this.validator.invalid){var d=jQuery(this.form[c]);b.push(d.offset().top)}0==b.length?this.sendData():(b.sort(function(a,b){return a-b}),a.scrollToError(b[0]),a.addButtonsActions())},this.submitForm=function(){return WMPJSInterface.AjaxUpload.dosubmit(a.form,{onStart:a.startUploadingData,onComplete:a.completeUploadingData})},this.sendData=function(){jQuery("#"+this.form.id,this.DOMDoc).unbind("submit"),jQuery("#"+this.form.id,this.DOMDoc).bind("submit",function(){a.submitForm()}),jQuery("#"+this.form.id,this.DOMDoc).submit(),a.disableButton(a.send_btn)},this.startUploadingData=function(){return WMPJSInterface.Preloader.start(),setTimeout(function(){var b=a.form.elements;for(nElems=b.length,j=0;j<nElems;j++)b[j].disabled=!0},300),!0},this.completeUploadingData=function(b){if(jQuery("#"+a.form.id,a.DOMDoc).unbind("submit"),jQuery("#"+a.form.id,a.DOMDoc).bind("submit",function(){return!1}),WMPJSInterface.Preloader.remove(100),b=Boolean(Number(String(b))),1==b){var c="Your app has been successfully modified!";WMPJSInterface.Loader.display({message:c})}else{var c="There was an error. Please reload the page and try again.";WMPJSInterface.Loader.display({message:c})}setTimeout(function(){var b=a.form.elements;for(nElems=b.length,j=0;j<nElems;j++)b[j].disabled=!1},300),a.addButtonsActions()}}
